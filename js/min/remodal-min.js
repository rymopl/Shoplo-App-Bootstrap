!function($){"use strict";function t(t,e){this.settings=$.extend({},s,e),this.modal=t,this.buildDOM(),this.addEventListeners(),this.index=$[i].lookup.push(this)-1,this.busy=!1}var i="remodal",s={hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0};$[i]={lookup:[]};var e,o,n=function(t){var i=t.css("transition-duration")||t.css("-webkit-transition-duration")||t.css("-moz-transition-duration")||t.css("-o-transition-duration")||t.css("-ms-transition-duration")||0,s=t.css("transition-delay")||t.css("-webkit-transition-delay")||t.css("-moz-transition-delay")||t.css("-o-transition-delay")||t.css("-ms-transition-delay")||0;return 1e3*(parseFloat(i)+parseFloat(s))},a=function(){if($(document.body).height()<=$(window).height())return 0;var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",document.body.appendChild(t);var i=t.offsetWidth;t.style.overflow="scroll";var s=document.createElement("div");s.style.width="100%",t.appendChild(s);var e=s.offsetWidth;return t.parentNode.removeChild(t),i-e},d=function(){$(document.body).css("padding-right","+="+a()),$("html, body").addClass(i+"_lock")},r=function(){$(document.body).css("padding-right","-="+a()),$("html, body").removeClass(i+"_lock")},l=function(t){var i={},s,e;s=t.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),e=s.split(",");var o,n,a;for(o=0,n=e.length;n>o;o++)e[o]=e[o].split(":"),a=e[o][1],("string"==typeof a||a instanceof String)&&(a="true"===a||("false"===a?!1:a)),("string"==typeof a||a instanceof String)&&(a=isNaN(a)?a:+a),i[e[o][0]]=a;return i};t.prototype.buildDOM=function(){this.body=$(document.body),this.bg=$("."+i+"-bg"),this.modalClose=$("<a href='#'>").addClass(i+"-close"),this.overlay=$("<div>").addClass(i+"-overlay"),this.modal.hasClass(i)||this.modal.addClass(i),this.modal.css("visibility","visible"),this.modal.append(this.modalClose),this.overlay.append(this.modal),this.body.append(this.overlay),this.confirm=this.modal.find("."+i+"-confirm"),this.cancel=this.modal.find("."+i+"-cancel");var t=n(this.overlay),s=n(this.modal),e=n(this.bg);this.td=s>t?s:t,this.td=e>this.td?e:this.td},t.prototype.addEventListeners=function(){var t=this;this.modalClose.bind("click."+i,function(i){i.preventDefault(),t.close()}),this.cancel.bind("click."+i,function(i){i.preventDefault(),t.modal.trigger("cancel"),t.settings.closeOnCancel&&t.close()}),this.confirm.bind("click."+i,function(i){i.preventDefault(),t.modal.trigger("confirm"),t.settings.closeOnConfirm&&t.close()}),$(document).bind("keyup."+i,function(i){27===i.keyCode&&t.close()}),this.overlay.bind("click."+i,function(s){var e=$(s.target);e.hasClass(i+"-overlay")&&t.close()})},t.prototype.open=function(){if(!this.busy){this.busy=!0,this.modal.trigger("open");var t=this.modal.attr("data-"+i+"-id");t&&this.settings.hashTracking&&(o=$(window).scrollTop(),location.hash=t),e&&e!==this&&(e.overlay.hide(),e.body.removeClass(i+"_active")),e=this,d(),this.overlay.show();var s=this;setTimeout(function(){s.body.addClass(i+"_active"),setTimeout(function(){s.busy=!1,s.modal.trigger("opened")},s.td+50)},25)}},t.prototype.close=function(){if(!this.busy){this.busy=!0,this.modal.trigger("close"),this.settings.hashTracking&&this.modal.attr("data-"+i+"-id")===location.hash.substr(1)&&(location.hash="",$(window).scrollTop(o)),this.body.removeClass(i+"_active");var t=this;setTimeout(function(){t.overlay.hide(),r(),t.busy=!1,t.modal.trigger("closed")},t.td+50)}},$&&($.fn[i]=function(s){var e;return this.each(function(o,n){var a=$(n);null==a.data(i)&&(e=new t(a,s),a.data(i,e.index),e.settings.hashTracking&&a.attr("data-"+i+"-id")===location.hash.substr(1)&&e.open())}),e}),$(document).ready(function(){$(document).on("click","[data-"+i+"-target]",function(t){t.preventDefault();var s=t.currentTarget,e=s.getAttribute("data-"+i+"-target"),o=$("[data-"+i+"-id="+e+"]");$[i].lookup[o.data(i)].open()}),$(document).find("."+i).each(function(t,s){var e=$(s),o=e.data(i+"-options");o?("string"==typeof o||o instanceof String)&&(o=l(o)):o={},e[i](o)})});var c=function(t,s){var o=location.hash.replace("#","");if("undefined"==typeof s&&(s=!0),o){var n;try{n=$("[data-"+i+"-id="+o.replace(new RegExp("/","g"),"\\/")+"]")}catch(t){}if(n&&n.length){var a=$[i].lookup[n.data(i)];a&&a.settings.hashTracking&&a.open()}}else s&&e&&!e.busy&&e.settings.hashTracking&&e.close()};$(window).bind("hashchange."+i,c)}(window.jQuery||window.Zepto);